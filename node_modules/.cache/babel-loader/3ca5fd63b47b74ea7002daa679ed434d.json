{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jamesbarnes/Desktop/course_work/Stranger_Things/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jamesbarnes/Desktop/course_work/Stranger_Things/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jamesbarnes/Desktop/course_work/Stranger_Things/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import ReactDOM from\"react-dom\";import{BrowserRouter as Router,Route,Switch,Link}from\"react-router-dom\";import{callApi}from\"./api\";import{AccountForm,Posts,SinglePost,NewPostForm}from\"./components\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var App=function App(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),userData=_useState4[0],setUserData=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),posts=_useState6[0],setPosts=_useState6[1];var fetchUserData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(token){var _yield$callApi,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return callApi({url:\"/users/me\",token:token});case 2:_yield$callApi=_context.sent;data=_yield$callApi.data;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchUserData(_x){return _ref.apply(this,arguments);};}();var fetchPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$callApi2,posts;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return callApi({url:\"/posts\"});case 2:_yield$callApi2=_context2.sent;posts=_yield$callApi2.data.posts;return _context2.abrupt(\"return\",posts);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchPosts(){return _ref2.apply(this,arguments);};}();useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(token){_context3.next=3;break;}setToken(localStorage.getItem(\"token\"));return _context3.abrupt(\"return\");case 3:_context3.next=5;return fetchUserData(token);case 5:data=_context3.sent;if(data&&data.username){setUserData(data);}case 7:case\"end\":return _context3.stop();}}},_callee3);})),[token]);useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var posts;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetchPosts();case 2:posts=_context4.sent;setPosts(posts);case 4:case\"end\":return _context4.stop();}}},_callee4);})),[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Stranger's Things\"}),/*#__PURE__*/_jsx(Link,{to:\"/posts/new\",children:\"Add A Post\"}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",children:userData.username&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Hello \",userData.username]})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/posts\",children:/*#__PURE__*/_jsx(Posts,{posts:posts})}),/*#__PURE__*/_jsx(Route,{path:\"/posts/new\",children:/*#__PURE__*/_jsx(NewPostForm,{token:token,setPosts:setPosts,posts:posts,action:\"add\"})}),/*#__PURE__*/_jsx(Route,{path:\"/posts/:postId/edit\",children:/*#__PURE__*/_jsx(NewPostForm,{token:token,setPosts:setPosts,posts:posts,action:\"edit\"})}),/*#__PURE__*/_jsx(Route,{path:\"/posts/:postId\",children:/*#__PURE__*/_jsx(SinglePost,{posts:posts})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",children:/*#__PURE__*/_jsx(AccountForm,{action:\"register\",setToken:setToken,setUserData:setUserData})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",children:/*#__PURE__*/_jsx(AccountForm,{action:\"login\",setToken:setToken,setUserData:setUserData})})]})]});};ReactDOM.render(/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(App,{})}),document.getElementById(\"app\"));","map":{"version":3,"sources":["/Users/jamesbarnes/Desktop/course_work/Stranger_Things/src/index.js"],"names":["React","useState","useEffect","ReactDOM","BrowserRouter","Router","Route","Switch","Link","callApi","AccountForm","Posts","SinglePost","NewPostForm","App","token","setToken","userData","setUserData","posts","setPosts","fetchUserData","url","data","fetchPosts","localStorage","getItem","username","render","document","getElementById"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter as Router, Route, Switch, Link } from \"react-router-dom\";\nimport { callApi } from \"./api\";\nimport { AccountForm, Posts, SinglePost, NewPostForm } from \"./components\";\n\nconst App = () => {\n  const [token, setToken] = useState(\"\");\n  const [userData, setUserData] = useState({});\n  const [posts, setPosts] = useState([]);\n\n  const fetchUserData = async (token) => {\n    const { data } = await callApi({\n      url: \"/users/me\",\n      token,\n    });\n    return data;\n  };\n\n  const fetchPosts = async () => {\n    const {\n      data: { posts },\n    } = await callApi({\n      url: \"/posts\",\n    });\n    return posts;\n  };\n\n  useEffect(async () => {\n    // const posts = await fetchPosts();\n    // setPosts(posts);\n    if (!token) {\n      setToken(localStorage.getItem(\"token\"));\n      return;\n    }\n    const data = await fetchUserData(token);\n    if (data && data.username) {\n      setUserData(data);\n    }\n  }, [token]);\n\n  useEffect(async () => {\n    const posts = await fetchPosts();\n    setPosts(posts);\n  }, []);\n\n  return (\n    <>\n      <h1>Stranger's Things</h1>\n      <Link to=\"/posts/new\">Add A Post</Link>\n      <Switch>\n        <Route exact path=\"/\">\n          {userData.username && <div>Hello {userData.username}</div>}\n        </Route>\n        <Route exact path=\"/posts\">\n          <Posts posts={posts} />\n        </Route>\n        <Route path=\"/posts/new\">\n          <NewPostForm\n            token={token}\n            setPosts={setPosts}\n            posts={posts}\n            action=\"add\"\n          />\n        </Route>\n        <Route path=\"/posts/:postId/edit\">\n          <NewPostForm\n            token={token}\n            setPosts={setPosts}\n            posts={posts}\n            action=\"edit\"\n          />\n        </Route>\n        <Route path=\"/posts/:postId\">\n          <SinglePost posts={posts} />\n        </Route>\n        <Route path=\"/register\">\n          <AccountForm\n            action=\"register\"\n            setToken={setToken}\n            setUserData={setUserData}\n          />\n        </Route>\n        <Route path=\"/login\">\n          <AccountForm\n            action=\"login\"\n            setToken={setToken}\n            setUserData={setUserData}\n          />\n        </Route>\n      </Switch>\n    </>\n  );\n};\n\nReactDOM.render(\n  <Router>\n    <App />\n  </Router>,\n  document.getElementById(\"app\")\n);\n"]},"metadata":{},"sourceType":"module"}