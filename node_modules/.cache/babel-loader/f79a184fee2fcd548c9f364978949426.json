{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jamesbarnes/Desktop/course_work/Stranger_Things/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jamesbarnes/Desktop/course_work/Stranger_Things/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jamesbarnes/Desktop/course_work/Stranger_Things/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{Link,useHistory}from\"react-router-dom\";import{callApi}from\"../api\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AccountForm=function AccountForm(_ref){var action=_ref.action,setToken=_ref.setToken,setUserData=_ref.setUserData;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var isLogin=action===\"login\";var title=isLogin?\"Login\":\"Register\";var oppositeTitle=isLogin?\"Register\":\"Login\";var oppositeAction=isLogin?\"register\":\"login\";var history=useHistory();var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var _data$data;var data,token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();_context.next=3;return callApi({url:\"/users/\".concat(action),body:{user:{username:username,password:password}},method:\"POST\"});case 3:data=_context.sent;token=data===null||data===void 0?void 0:(_data$data=data.data)===null||_data$data===void 0?void 0:_data$data.token;if(token){localStorage.setItem(\"token\",token);setUsername(\"\");setPassword(\"\");setToken(token);history.push(\"/\");}case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:title}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"username\",required:true,onChange:function onChange(event){return setUsername(event.target.value);}}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"password\",onChange:function onChange(event){return setPassword(event.target.value);}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:title})]}),/*#__PURE__*/_jsx(Link,{to:\"/\".concat(oppositeAction),children:oppositeTitle})]});};export default AccountForm;","map":{"version":3,"sources":["/Users/jamesbarnes/Desktop/course_work/Stranger_Things/src/components/AccountForm.js"],"names":["React","useState","Link","useHistory","callApi","AccountForm","action","setToken","setUserData","username","setUsername","password","setPassword","isLogin","title","oppositeTitle","oppositeAction","history","handleSubmit","event","preventDefault","url","body","user","method","data","token","localStorage","setItem","push","target","value"],"mappings":"ogBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,IAAT,CAAeC,UAAf,KAAiC,kBAAjC,CACA,OAASC,OAAT,KAAwB,QAAxB,C,6IAEA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,MAAuC,IAApCC,CAAAA,MAAoC,MAApCA,MAAoC,CAA5BC,QAA4B,MAA5BA,QAA4B,CAAlBC,WAAkB,MAAlBA,WAAkB,CACzD,cAAgCP,QAAQ,CAAC,EAAD,CAAxC,wCAAOQ,QAAP,eAAiBC,WAAjB,eACA,eAAgCT,QAAQ,CAAC,EAAD,CAAxC,yCAAOU,QAAP,eAAiBC,WAAjB,eACA,GAAMC,CAAAA,OAAO,CAAGP,MAAM,GAAK,OAA3B,CACA,GAAMQ,CAAAA,KAAK,CAAGD,OAAO,CAAG,OAAH,CAAa,UAAlC,CACA,GAAME,CAAAA,aAAa,CAAGF,OAAO,CAAG,UAAH,CAAgB,OAA7C,CACA,GAAMG,CAAAA,cAAc,CAAGH,OAAO,CAAG,UAAH,CAAgB,OAA9C,CACA,GAAMI,CAAAA,OAAO,CAAGd,UAAU,EAA1B,CAEA,GAAMe,CAAAA,YAAY,2FAAG,iBAAOC,KAAP,gJACnBA,KAAK,CAACC,cAAN,GADmB,sBAEAhB,CAAAA,OAAO,CAAC,CACzBiB,GAAG,kBAAYf,MAAZ,CADsB,CAEzBgB,IAAI,CAAE,CAAEC,IAAI,CAAE,CAAEd,QAAQ,CAARA,QAAF,CAAYE,QAAQ,CAARA,QAAZ,CAAR,CAFmB,CAGzBa,MAAM,CAAE,MAHiB,CAAD,CAFP,QAEbC,IAFa,eAObC,KAPa,CAOLD,IAPK,SAOLA,IAPK,6BAOLA,IAAI,CAAEA,IAPD,qCAOL,WAAYC,KAPP,CASnB,GAAIA,KAAJ,CAAW,CACTC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BF,KAA9B,EACAhB,WAAW,CAAC,EAAD,CAAX,CACAE,WAAW,CAAC,EAAD,CAAX,CACAL,QAAQ,CAACmB,KAAD,CAAR,CACAT,OAAO,CAACY,IAAR,CAAa,GAAb,EACD,CAfkB,sDAAH,kBAAZX,CAAAA,YAAY,6CAAlB,CAiBA,mBACE,wCACE,oBAAKJ,KAAL,EADF,cAEE,cAAM,QAAQ,CAAEI,YAAhB,wBACE,cACE,IAAI,CAAC,MADP,CAEE,WAAW,CAAC,UAFd,CAGE,QAAQ,KAHV,CAIE,QAAQ,CAAE,kBAACC,KAAD,QAAWT,CAAAA,WAAW,CAACS,KAAK,CAACW,MAAN,CAAaC,KAAd,CAAtB,EAJZ,EADF,cAOE,cACE,IAAI,CAAC,UADP,CAEE,WAAW,CAAC,UAFd,CAGE,QAAQ,CAAE,kBAACZ,KAAD,QAAWP,CAAAA,WAAW,CAACO,KAAK,CAACW,MAAN,CAAaC,KAAd,CAAtB,EAHZ,EAPF,cAYE,eAAQ,IAAI,CAAC,QAAb,UAAuBjB,KAAvB,EAZF,GAFF,cAgBE,KAAC,IAAD,EAAM,EAAE,YAAME,cAAN,CAAR,UAAiCD,aAAjC,EAhBF,GADF,CAoBD,CA9CD,CAgDA,cAAeV,CAAAA,WAAf","sourcesContent":["import React, { useState } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport { callApi } from \"../api\";\n\nconst AccountForm = ({ action, setToken, setUserData }) => {\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const isLogin = action === \"login\";\n  const title = isLogin ? \"Login\" : \"Register\";\n  const oppositeTitle = isLogin ? \"Register\" : \"Login\";\n  const oppositeAction = isLogin ? \"register\" : \"login\";\n  const history = useHistory();\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    const data = await callApi({\n      url: `/users/${action}`,\n      body: { user: { username, password } },\n      method: \"POST\",\n    });\n    const token = data?.data?.token;\n\n    if (token) {\n      localStorage.setItem(\"token\", token);\n      setUsername(\"\");\n      setPassword(\"\");\n      setToken(token);\n      history.push(\"/\");\n    }\n  };\n  return (\n    <>\n      <h2>{title}</h2>\n      <form onSubmit={handleSubmit}>\n        <input\n          type=\"text\"\n          placeholder=\"username\"\n          required\n          onChange={(event) => setUsername(event.target.value)}\n        ></input>\n        <input\n          type=\"password\"\n          placeholder=\"password\"\n          onChange={(event) => setPassword(event.target.value)}\n        ></input>\n        <button type=\"submit\">{title}</button>\n      </form>\n      <Link to={`/${oppositeAction}`}>{oppositeTitle}</Link>\n    </>\n  );\n};\n\nexport default AccountForm;\n"]},"metadata":{},"sourceType":"module"}