(this["webpackJsonp2021-11-27"]=this["webpackJsonp2021-11-27"]||[]).push([[0],{36:function(e,t,n){"use strict";n.r(t);var r=n(4),c=n.n(r),s=n(8),a=n(9),o=n(1),i=n(22),u=n.n(i),l=n(10),p=n(2),j="https://strangers-things.herokuapp.com/api/2108-LSU-RM-WEB-PT",d=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r,s,a,o,i,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,r=t.method,s=t.token,a=t.body,e.prev=1,o={method:r?r.toUpperCase():"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},s&&(o.headers.Authorization="Bearer ".concat(s)),console.log("Call API Request URL: ",j+n),console.log("Call API Options: ",o),e.next=8,fetch(j+n,o);case 8:return i=e.sent,e.next=11,i.json();case 11:if(u=e.sent,console.log("data: ",u),!u.error){e.next=15;break}throw u.error;case 15:return e.abrupt("return",u);case 18:e.prev=18,e.t0=e.catch(1),console.error("ERROR: ",e.t0);case 21:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t){return e.apply(this,arguments)}}(),b=n(0),h=function(e){var t=e.action,n=e.setToken,r=(e.setUserData,Object(o.useState)("")),i=Object(a.a)(r,2),u=i[0],j=i[1],h=Object(o.useState)(""),O=Object(a.a)(h,2),x=O[0],f=O[1],v="login"===t,g=v?"Login":"Register",m=v?"Register":"Login",w=v?"register":"login",k=Object(p.f)(),y=function(){var e=Object(s.a)(c.a.mark((function e(r){var s,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,d({url:"/users/".concat(t),body:{user:{username:u,password:x}},method:"POST"});case 3:a=e.sent,(o=null===a||void 0===a||null===(s=a.data)||void 0===s?void 0:s.token)&&(localStorage.setItem("token",o),j(""),f(""),n(o),k.push("/"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h2",{children:g}),Object(b.jsxs)("form",{onSubmit:y,children:[Object(b.jsx)("input",{type:"text",placeholder:"username",required:!0,onChange:function(e){return j(e.target.value)}}),Object(b.jsx)("input",{type:"password",placeholder:"password",onChange:function(e){return f(e.target.value)}}),Object(b.jsx)("button",{type:"submit",children:g})]}),Object(b.jsx)(l.b,{to:"/".concat(w),children:m})]})},O={searchContainer:{display:"flex",justifyContent:"center",padding:"16px",alignItems:"center"},searchInput:{margin:"0 16px"}},x=function(e){var t=e.posts,n=Object(p.f)(),r=Object(o.useState)(""),c=Object(a.a)(r,2),s=c[0],i=c[1],u=t.filter((function(e){return function(e,t){for(var n=t.toLowerCase(),r=0,c=[e.description,e.location,e.title,e.author.username];r<c.length;r++)if(c[r].toLowerCase().includes(n))return!0}(e,s)}));return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{style:O.searchContainer,children:[Object(b.jsx)("h2",{children:"Posts"}),Object(b.jsx)("input",{style:O.searchInput,type:"text",placeholder:"search for posts",value:s,onChange:function(e){console.log(e.target.value),i(e.target.value)}})]}),u.length?u.map((function(e){return Object(b.jsxs)("div",{style:{border:"1px solid black"},children:[Object(b.jsx)("h5",{children:e.title}),Object(b.jsxs)("div",{children:["Posted by: ",e.author.username]}),Object(b.jsxs)("div",{children:["Description: ",e.description]}),Object(b.jsxs)("div",{children:["Location: ",e.location]}),Object(b.jsx)("button",{onClick:function(){return n.push("/posts/".concat(e._id))},children:"View Post"})]},e._id)})):Object(b.jsx)("div",{children:"No posts to display"})]})},f=function(e){var t=e.posts,n=Object(p.g)().postId,r=t.find((function(e){return n===e._id}));return console.log("SINGLE POST",r),Object(b.jsx)(b.Fragment,{children:r?Object(b.jsxs)("div",{children:[Object(b.jsx)("h3",{children:r.title}),Object(b.jsxs)("p",{children:["Posted by: ",r.author.username]}),Object(b.jsxs)("p",{children:["Price: ",r.price]}),Object(b.jsxs)("p",{children:["Location: ",r.location]}),Object(b.jsxs)("p",{children:["Delivers: ",r.willDeliver?"Yes":"No"]})]}):""})},v=n(14),g=n(15),m=n(20),w=function(e){var t=e.token,n=e.setPosts,r=e.posts,i=e.action,u=Object(p.f)(),l=Object(p.g)().postId,j=Object(o.useState)({title:"",description:"",price:0,location:"",willDeliver:!1}),h=Object(a.a)(j,2),O=h[0],x=h[1],f="edit"===i,w=f?"Edit this post":"Add a new post",k=f?"PATCH":"POST",y=f?"/posts/".concat(l):"/posts",C=function(){var e=Object(s.a)(c.a.mark((function e(s){var a,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.prev=1,e.next=4,d({url:y,method:k,body:{post:{title:O.title,description:O.description,price:O.price,location:O.location,willDeliver:O.willDeliver}},token:t});case 4:a=e.sent,o=a.data.post,f?(i=r.filter((function(e){return e._id!==l})),n([].concat(Object(m.a)(i),[o]))):n([].concat(Object(m.a)(r),[o])),u.push("/posts"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("error adding a post: ",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),S=function(e){return function(t){x("willDeliver"===e?Object(g.a)(Object(g.a)({},O),{},Object(v.a)({},e,t.target.checked)):Object(g.a)(Object(g.a)({},O),{},Object(v.a)({},e,t.target.value)))}};return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h2",{children:w}),Object(b.jsxs)("form",{onSubmit:C,children:[Object(b.jsx)("input",{type:"text",placeholder:"title",onChange:S("title"),value:O.title}),Object(b.jsx)("input",{type:"text",placeholder:"description",onChange:S("description"),value:O.description}),Object(b.jsx)("input",{type:"number",placeholder:"price",onChange:S("price"),value:O.price}),Object(b.jsx)("input",{type:"text",placeholder:"location",onChange:S("location"),value:O.location}),Object(b.jsxs)("label",{children:["Deliver ?",Object(b.jsx)("input",{type:"checkbox",onChange:S("willDeliver"),value:O.willDeliver})]}),Object(b.jsx)("button",{children:w})]})]})},k=function(){var e=Object(o.useState)(""),t=Object(a.a)(e,2),n=t[0],r=t[1],i=Object(o.useState)({}),u=Object(a.a)(i,2),j=u[0],O=u[1],v=Object(o.useState)([]),g=Object(a.a)(v,2),m=g[0],k=g[1],y=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({url:"/users/me",token:t});case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({url:"/posts"});case 2:return t=e.sent,n=t.data.posts,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)(Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return r(localStorage.getItem("token")),e.abrupt("return");case 3:return e.next=5,y(n);case 5:(t=e.sent)&&t.username&&O(t);case 7:case"end":return e.stop()}}),e)}))),[n]),Object(o.useEffect)(Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:t=e.sent,k(t);case 4:case"end":return e.stop()}}),e)}))),[]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{children:"Stranger's Things"}),Object(b.jsx)(l.b,{to:"/posts/new",children:"Add A Post"}),Object(b.jsxs)(p.c,{children:[Object(b.jsx)(p.a,{exact:!0,path:"/",children:j.username&&Object(b.jsxs)("div",{children:["Hello ",j.username]})}),Object(b.jsx)(p.a,{exact:!0,path:"/posts",children:Object(b.jsx)(x,{posts:m})}),Object(b.jsx)(p.a,{path:"/posts/new",children:Object(b.jsx)(w,{token:n,setPosts:k,posts:m,action:"add"})}),Object(b.jsx)(p.a,{path:"/posts/:postId/edit",children:Object(b.jsx)(w,{token:n,setPosts:k,posts:m,action:"edit"})}),Object(b.jsx)(p.a,{path:"/posts/:postId",children:Object(b.jsx)(f,{posts:m})}),Object(b.jsx)(p.a,{path:"/register",children:Object(b.jsx)(h,{action:"register",setToken:r,setUserData:O})}),Object(b.jsx)(p.a,{path:"/login",children:Object(b.jsx)(h,{action:"login",setToken:r,setUserData:O})})]})]})};u.a.render(Object(b.jsx)(l.a,{children:Object(b.jsx)(k,{})}),document.getElementById("app"))}},[[36,1,2]]]);
//# sourceMappingURL=main.c750167d.chunk.js.map